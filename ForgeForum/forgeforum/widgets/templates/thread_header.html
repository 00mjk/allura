<div xmlns="http://www.w3.org/1999/xhtml"
     xmlns:py="http://genshi.edgewall.org/"
     xmlns:xi="http://www.w3.org/2001/XInclude"
     py:strip="True">
  <xi:include href="${g.pyforge_templates}/master.html"/>
  <?python from pyforge.lib.security import has_artifact_access?>

  <h1 class="title">$value.subject</h1>

  <div class="breadcrumbs" >
    <ul>${crumbs(value.discussion.breadcrumbs())}</ul>
  </div>

  <py:if test="value.discussion.announcements">
    <h3>Announcements</h3>
    ${widgets.announcements_table.display(value=value.discussion.announcements)}
  </py:if>
  <div  py:if="pagesize"
        py:with="cur_page=offset / pagesize; num_pages=total/pagesize">
    <p>Page ${1 + cur_page} of ${1 + num_pages}</p>
    <a href=".">&lt;&lt;</a>
    <a href="?offset=${offset - pagesize}">&lt;</a>
    <a href="?offset=${offset + pagesize}">&gt;</a>
    <a href="?offset=${total - pagesize}">&gt;&gt;</a>
  </div>
  <p>Thread Shortlink: <input readonly="true" value="[${value.shorthand_id()}]"/></p>
  <div class="title-pane closed"
       py:if="show_moderate and has_artifact_access('moderate', value)()">
    <span class="title">Moderate thread</span>
    <div class="content">
      ${widgets.moderate_thread.display(value=value, action=value.url()+'moderate')}
    </div>
  </div>
</div>
